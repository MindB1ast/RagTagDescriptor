





Обобщение бинарных мер качества на многоклассовый случай | Машинное и глубокое обучение






[IMAGE]














Перейти к основному содержимому
[IMAGE]
Машинное обучение
Глубокое обучение
Обозначения
Лицензия
Машинное обучение
Введение
Основы машинного обучения
Подготовка данных
Классификаторы в общем виде
Метрические методы прогнозирования
Линейная регрессия и её обобщения
Оценка качества регрессии
Линейная классификация
Многоклассовая классификация набором бинарных классификаторов
Численная оптимизация
Оценка качества классификации
Базовые меры качества многоклассовой классификации
Специальные меры качества для бинарной классификации
Обобщение бинарных мер качества на многоклассовый случай
ROC-кривая
Лучший классификатор на ROC кривой
Эквивалентное определение AUC
Контроль качества предсказания вероятностей
Дополнительная литература
Вопросы
Решающие деревья
Переобучение и недообучение
Ансамбли моделей
Бустинг
Интерпретация простых моделей
Интерпретация сложных моделей
Заключение
Оценка качества классификации
Обобщение бинарных мер качества на многоклассовый случай
Содержание этой страницы
Обобщение бинарных мер качества на многоклассовый случай


Меры качества бинарных классификаторов, рассмотренные 
в предыдущем разделе
, могут быть обобщены на многоклассовый случай 
$y\in\{1,2,...C\}$
y
∈
{
1
,
2
,
...
C
}
 через 
макроусреднение
 (macroaveraging) т.е. простое усреднение бинарных мер качества по классам:


$\text{Precision}_{\text{macro}}=\frac{1}{C}\sum_{c=1}^{C}\frac{TP_{c}}{\widehat{N}_{c}},$
Precision
macro
​
=
C
1
​
c
=
1
∑
C
​
N
c
​
T
P
c
​
​
,


$\text{Recall}_{\text{macro}}=\frac{1}{C}\sum_{c=1}^{C}\frac{TP_{c}}{N_{c}},$
Recall
macro
​
=
C
1
​
c
=
1
∑
C
​
N
c
​
T
P
c
​
​
,


где






$TP_c$
T
P
c
​
 - количество верных классификаций объектов класса 
$c$
c
,






$N_c$
N
c
​
 - количество объектов класса 
$c$
c
,






$\hat{N}_c$
N
^
c
​
 - количество объектов, предсказанных классом 
$c$
c
.






Если же считать 
микроусреднение
 (microaveraging) этих величин, то получим одно и то же число, равное многоклассовой accuracy:


$\text{Precision}_{\text{micro}} = \frac{\sum_{c=1}^{C}TP_{c}}{\sum_{c=1}^{C}\widehat{N}_{c}}=\frac{\sum_{c=1}^{C}TP_{c}}{N},$
Precision
micro
​
=
∑
c
=
1
C
​
N
c
​
∑
c
=
1
C
​
T
P
c
​
​
=
N
∑
c
=
1
C
​
T
P
c
​
​
,


$\text{Recall}_{\text{micro}} = \frac{\sum_{c=1}^{C}TP_{c}}{\sum_{c=1}^{C}N_{c}}=\frac{\sum_{c=1}^{C}TP_{c}}{N}$
Recall
micro
​
=
∑
c
=
1
C
​
N
c
​
∑
c
=
1
C
​
T
P
c
​
​
=
N
∑
c
=
1
C
​
T
P
c
​
​


где 
$N$
N
 - общее число объектов в выборке.


Детальный разбор этих характеристик с примерами расчёта можно прочитать в 
[1]
.


Разница между микро- и макроусреднением
Макроусреднение усредняет 
по классам
, независимо от их размера. Если мера качества высокая на частотных классах и низкая на редких, то макроусреднение даст низкий результат, в отличие от микроусреднения, которое усредняет 
по объектам
.


Макроусреднённая по классам величина средней точности 
average precision
 называется 
mean average precision
 (mAP):


$mAP=\frac{1}{C}\sum_{c=1}^C AP_c$
m
A
P
=
C
1
​
c
=
1
∑
C
​
A
P
c
​


Литература
​




EvidentlyAI: accuracy, precision, and recall in multi-class classification.


Предыдущая страница
Специальные меры качества для бинарной классификации
Следующая страница
ROC-кривая
Литература
© 2023-25 
Виктор Китов.
 
Новости проекта.

